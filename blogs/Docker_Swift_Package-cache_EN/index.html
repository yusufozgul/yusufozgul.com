<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"/><meta property="og:site_name" content="Yusuf Özgül | Blog | Resume | Portfolio"/><link rel="canonical" href="https://yusufozgul.com/blogs/Docker_Swift_Package-cache_EN"/><meta name="twitter:url" content="https://yusufozgul.com/blogs/Docker_Swift_Package-cache_EN"/><meta property="og:url" content="https://yusufozgul.com/blogs/Docker_Swift_Package-cache_EN"/><title>Docker Swift Package cache | Yusuf Özgül | Blog | Resume | Portfolio</title><meta name="twitter:title" content="Docker Swift Package cache | Yusuf Özgül | Blog | Resume | Portfolio"/><meta property="og:title" content="Docker Swift Package cache | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="description" content="How can we cache swift packages while building on docker?"/><meta name="twitter:description" content="How can we cache swift packages while building on docker?"/><meta property="og:description" content="How can we cache swift packages while building on docker?"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/gallery.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/upload-images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="twitter:image" content="https://yusufozgul.com/upload-images/"/><meta property="og:image" content="https://yusufozgul.com/upload-images/"/></head><body class="main-wrapper"><header><link rel="stylesheet" href="/navigationStyle.css" type="text/css"/><nav class="header navBar"><div class="navArea"><input type="checkbox" id="check"/><label for="check"><img src="/upload-images/base/menu-icon.svg" width="30" height="30" class="checkbtn"/></label><label class="logo"><a href="/">Yusuf Özgül</a></label><ul class="navContent" id="hoverEnabled"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li><li><a href="/projects">Projects</a></li><li><a href="/blogs" class="active">Blog</a></li></ul></div></nav></header><div class="wrapper"><h2 class="post-title">Docker Swift Package cache</h2><a><p>May 16, 2021<br/>Reading 6 minutes</p></a><ul class="tag-list"><li class="swift"><a href="/tags/swift">Swift</a></li><li class="docker"><a href="/tags/docker">Docker</a></li></ul><div class="post-description"><div><p>I deployed a small Vapor project I made using Docker. Every build re-downloads all dependencies, but dependencies do not change. It was time and network wasting.</p><h3>So what can we do to solve this?</h3><p>Actually, it is quite easy, Docker makes the decision according to the changes of the files at every step. So if we never changed our project, it would take the libraries using the cache not re-download, but our files are changing. So what if we just copy the unchanged ones first and then copy the rest?</p><pre><code># <span class="type">Copy</span> entire repo into container
<span class="type">COPY</span> . .

# <span class="type">Compile
RUN</span> swift build -c release -<span class="type">Xswiftc</span> -g
</code></pre><p>We copied all the files into the container and called the swift build command. Since it will build completely from begin, it will first download libraries and then build.</p><pre><code># <span class="type">Copy</span> swift package file
<span class="type">COPY Package</span>.<span class="property">swift</span> .

# <span class="type">Download</span> swift packages
<span class="type">RUN</span> swift package resolve
</code></pre><p>Before copying all files, only copy Package.swift file and call swift package resolve command so that only the libraries download. Then, during build, these libraries are not downloaded again and continue to be used.</p><p>So what happens during the next build?</p><p>We just copied Package.swift and to download libraries. Same file as the previous build has not changed because. In this case, the docker will go read this from the cache and save time and network.</p><p>In this short article, I explained the optimization for swift package in Docker, thank you for reading.</p></div></div></div><footer><p><a href="https://github.com/johnsundell/publish">Generated using Publish</a></p><p><a href="/feed.rss">RSS feed</a></p><p><a href="https://github.com/yusufozgul">Developed Yusuf Özgül</a></p></footer></body></html>