<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Yusuf Özgül | Blog | Resume | Portfolio"/><link rel="canonical" href="https://yusufozgul.com/blogs/SigninWithApple"/><meta name="twitter:url" content="https://yusufozgul.com/blogs/SigninWithApple"/><meta name="og:url" content="https://yusufozgul.com/blogs/SigninWithApple"/><title>Sign in with Apple Nasıl Kullanılır? | Yusuf Özgül | Blog | Resume | Portfolio</title><meta name="twitter:title" content="Sign in with Apple Nasıl Kullanılır? | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="og:title" content="Sign in with Apple Nasıl Kullanılır? | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="description" content="Sign in with Apple özelliği WWDC 2019’da tanıtıldığında diğer bir çok üçüncü parti giriş servislerinden çok daha iyi özellikleriyle geldi. Vermek istediğiniz bilgileri kontrol edebilmek araya bir email yönlendirmesi koymak gibi. Gizlilik konusunda atılan bu güzel adımda Apple’a güvenebildiğimiz kadar gizliliğimizi korumuş oluyoruz."/><meta name="twitter:description" content="Sign in with Apple özelliği WWDC 2019’da tanıtıldığında diğer bir çok üçüncü parti giriş servislerinden çok daha iyi özellikleriyle geldi. Vermek istediğiniz bilgileri kontrol edebilmek araya bir email yönlendirmesi koymak gibi. Gizlilik konusunda atılan bu güzel adımda Apple’a güvenebildiğimiz kadar gizliliğimizi korumuş oluyoruz."/><meta name="og:description" content="Sign in with Apple özelliği WWDC 2019’da tanıtıldığında diğer bir çok üçüncü parti giriş servislerinden çok daha iyi özellikleriyle geldi. Vermek istediğiniz bilgileri kontrol edebilmek araya bir email yönlendirmesi koymak gibi. Gizlilik konusunda atılan bu güzel adımda Apple’a güvenebildiğimiz kadar gizliliğimizi korumuş oluyoruz."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/gallery.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/upload-images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="twitter:image" content="https://yusufozgul.com/upload-images/"/><meta name="og:image" content="https://yusufozgul.com/upload-images/"/></head><body class="main-wrapper"><header><link rel="stylesheet" href="/navigationStyle.css" type="text/css"/><nav class="header navBar"><div class="navArea"><input type="checkbox" id="check"/><label for="check"><img src="/upload-images/base/menu-icon.svg" width="30" height="30" class="checkbtn"/></label><label class="logo"><a href="/">Yusuf Özgül</a></label><ul class="navContent" id="hoverEnabled"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li><li><a href="/projects">Projects</a></li><li><a href="/blogs" class="active">Blog</a></li></ul></div></nav></header><div class="wrapper"><h2 class="post-title">Sign in with Apple Nasıl Kullanılır?</h2><a><p>June 5, 2019<br/>Reading 14 minutes</p></a><ul class="tag-list"><li class="swift"><a href="/tags/swift">Swift</a></li><li class="apple"><a href="/tags/apple">Apple</a></li><li class="other"><a href="/tags/sign-in-with-apple">Sign in with Apple</a></li><li class="other"><a href="/tags/auth">Auth</a></li></ul><div class="post-description"><div><p>Sign in with Apple özelliği WWDC 2019’da tanıtıldığında diğer bir çok üçüncü parti giriş servislerinden çok daha iyi özellikleriyle geldi. Vermek istediğiniz bilgileri kontrol edebilmek araya bir email yönlendirmesi koymak gibi. Gizlilik konusunda atılan bu güzel adımda Apple’a güvenebildiğimiz kadar gizliliğimizi korumuş oluyoruz. Artık kullanmadığımız, hesabımızı kapattığımız hizmetlerden spam mailler almayacağız. Birde hangi uygulamalar bilgilerimizi satıyor görebileceğiz 🙂</p><p>Yıl sonuna kadar bu özellik uygulamada üçüncü parti giriş hizmeti kullananlar için zorunlu olacak, Apple bazen gerekli konularda iyi yaptırımlar uyguluyor. Hadi şimdi bu özelliği nasıl kolayca uygulamamıza ekleyebileceğimize bakalım.</p><p>Başlamadan eklemek istediğim şeyler var:</p><ul><li>Bu özellik iOS 13 ve daha üst sürüm gerektirir.</li><li>Uygulamanız UIKit kullansa bile kullanabilirsiniz.</li><li>Xcode 11 kullanmanız gerekmektedir.</li><li>Son olarak yayınlanmış son Apple Geliştirici Şartlarını kabul etmelisiniz.</li></ul><p>Bu arada karşılaştığım bir sorun bu özellik ücretsiz hesap ile geliştirme yapıyorsanız kullanılamıyor. developer.apple.com’da son Geliştirici Şartları görünmüyor. Developer hesabında ise herhangi bir sorun yok.</p><h3>Başlayalım</h3><p>Xcode 11 beta’yı açıp bir proje oluşturun. Bu yazıda uygulama UIKit ile geliştirilmiş olacak dilerseniz SwiftUI’da kullanabilirsiniz herhangi bir fark bulunmuyor.</p><p>Proje ayarlarımızı yapalım. <img src="/upload-images/SigninWithApple/upload-270232875.png" width="100%"/></p><img src="/upload-images/SigninWithApple/upload-299754126.png" width="100%"/><p>Proje ayarlarımızdan sonra kodumuza başlayabiliriz. Yapacağımız ilk iş AuthenticationServices’ı ViewController’ımıza import etmek</p><pre><code><span class="keyword">import</span> AuthenticationServices
</code></pre><p>Şimdi AuthenticationServices’ten ASAuthorizationAppleIDButton’u kullanacağız, esasında bu bir buton ve UIControl kütüphanesine bağlı. Bu da demek oluyor ki bunu bir buton gibi düşüneceğiz ve target verip farklı bir fonksiyonda bunun işlemlerini yapacağız. &gt; gist 5451b0c844f8c627aeca642387f0747d</p><p>Butonumuzu oluşturduk, aksiyon işlemini nerede yapacağını söyledik ve hangi event ile tetikleneceğini belirledik. Ardından view’umuzun merkezine ekledik.</p><h4>Bir göz atalım nasıl görünüyor ?</h4><img src="/upload-images/SigninWithApple/upload-899708053.png" width="100%"/><p>Şimdi sıra geldi bu işin merkezine. Butonumuzun aksiyon metoduna gelelim.</p><p>Burda ilk olarak AppleID Provider kullanacağız. Bu bize Bilgileri sağlayacak. Buna bir request oluşturarak hangi bilgileri alabileceğimizi belirliyoruz. Şu an kullanılabilir iki veri bulunuyor. Biri e-Posta diğeri tam isim. AppleID Provider’e bir request oluşturduk ve buna bize email ve tam isimi vermesini istedik. Sonra bir Controller oluşturduk. Bu controller’a gereken delegasyon ve içerik sağlayıcısını ( presentationContextProvider ) self olarak verdik.</p><pre><code><span class="keyword">@objc func</span> authAppleID()
    {
        <span class="keyword">let</span> appleIDProvider = <span class="type">ASAuthorizationAppleIDProvider</span>()
        <span class="keyword">let</span> authRequest = appleIDProvider.<span class="call">createRequest</span>()
        authRequest.<span class="property">requestedScopes</span> = [.<span class="dotAccess">email</span>, .<span class="dotAccess">fullName</span>]
        
        <span class="keyword">let</span> authController = <span class="type">ASAuthorizationController</span>(authorizationRequests: [authRequest])
        authController.<span class="property">presentationContextProvider</span> = <span class="keyword">self</span>
        authController.<span class="property">delegate</span> = <span class="keyword">self</span>
        authController.<span class="call">performRequests</span>()
        
    }</pre></code><p>Şimdi aslında işlem bitti ancak daha da iyileştirmek en iyisi. Bir extension ekleyelim. Bu extension ASAuthorizationControllerDelegate, ASAuthorizationControllerPresentationContextProviding’dan kalıtımını alsın.</p><p>Xcode’un istediğini yapalım ve presentationAnchor fonksiyonunu implementde edelim. İçine geri dönüş değerini verelim.</p><pre><code><span class="keyword">return self</span>.<span class="property">view</span>.<span class="property">window</span>!
</code></pre><p>Şimdi de giriş yapılma işleminde hata oluşup olmadığını, başarılı giriş yapılmışsa eğer kullanıcı bilgilerini alalım.</p><pre><code><span class="keyword">extension</span> <span class="type">ViewController</span>: <span class="type">ASAuthorizationControllerDelegate</span>, <span class="type">ASAuthorizationControllerPresentationContextProviding</span>
{
    <span class="keyword">func</span> authorizationController(controller: <span class="type">ASAuthorizationController</span>, didCompleteWithAuthorization authorization: <span class="type">ASAuthorization</span>)
    {
        <span class="keyword">guard let</span> appleIDCredential = authorization.<span class="property">credential</span> <span class="keyword">as</span>? <span class="type">ASAuthorizationAppleIDCredential</span> <span class="keyword">else</span> { <span class="keyword">return</span> }
        
        <span class="call">print</span>(<span class="string">"USER:</span> \(appleIDCredential.<span class="property">user</span>)<span class="string">"</span>)
        <span class="call">print</span>(<span class="string">"EMAIL:</span> \(appleIDCredential.<span class="property">email</span>!)<span class="string">"</span>)
        <span class="call">print</span>(<span class="string">"FULL NAME:</span> \(appleIDCredential.<span class="property">fullName</span>!)<span class="string">"</span>)
    }
    
    <span class="keyword">func</span> presentationAnchor(for controller: <span class="type">ASAuthorizationController</span>) -&gt; <span class="type">ASPresentationAnchor</span>
    {
        <span class="keyword">return self</span>.<span class="property">view</span>.<span class="property">window</span>!
    }
}</pre></code><p>İşleminizin bir sorunla karşılaşmadığını doğrulamak için guard let ile kontrolümüzü yaptık. Eğer sorun yoksa kayıt yapan kullanıcının verilerini konsola yazdırdık.</p><img src="/upload-images/SigninWithApple/upload-558219504.png" width="100%"/><p>)</p><p>Bilgilerimizi gerçek email ile kullanırsak ne oluyor, Apple’ın gizlilik için oluşturduğu mail ile kullanırsak kullanıcı bilgileri aşağıdaki gibi oluyor.</p><img src="/upload-images/SigninWithApple/upload-403950479.png" width="100%"/><p>Apple’ın bu WWDC’de tanıttığı güzel bir özelliği elimden geldiğince anlattım, sorularınız olursa yorum kısmına ya da blogumun iletişim kısmından bana ulaşabilirsiniz, bugsız günler 🙂</p><p>Kodlar İçin <a href="http://https://github.com/yusufozgul/SignWithAppleTutorial "GitHub Hesabım"">GitHub Hesabım</a></p><hr><p>Kaynaklar:</p><p>https://medium.com/q42-engineering/sign-in-with-apple-e45325cd9d0</p><p>https://developer.apple.com/sign-in-with-apple/get-started/</p></div></div></div><footer><p><a href="https://github.com/johnsundell/publish">Generated using Publish</a></p><p><a href="/feed.rss">RSS feed</a></p><p><a href="https://github.com/yusufozgul">Developed Yusuf Özgül</a></p></footer></body></html>