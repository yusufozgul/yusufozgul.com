<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Yusuf Özgül | Blog | Resume | Portfolio"/><link rel="canonical" href="https://yusufozgul.com/blogs/codable-Ayrintili-Hata-Ayiklama"/><meta name="twitter:url" content="https://yusufozgul.com/blogs/codable-Ayrintili-Hata-Ayiklama"/><meta name="og:url" content="https://yusufozgul.com/blogs/codable-Ayrintili-Hata-Ayiklama"/><title>Swift Codable ayrıntılı hata ayıklama | Yusuf Özgül | Blog | Resume | Portfolio</title><meta name="twitter:title" content="Swift Codable ayrıntılı hata ayıklama | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="og:title" content="Swift Codable ayrıntılı hata ayıklama | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="description" content="İnternetten bir veriyi alıp ya da gönderirken JSON kullanarak aktarmak çok sık kullanılmaktadır. Swift 4 ile hayatımıza giren Codable aslında Decodable ve Encodable protokollerinin birleşiminden oluşmaktadır. Bu yazıda decode sırasında oluşan hataları ayrıntılı şekilde ele alacağız."/><meta name="twitter:description" content="İnternetten bir veriyi alıp ya da gönderirken JSON kullanarak aktarmak çok sık kullanılmaktadır. Swift 4 ile hayatımıza giren Codable aslında Decodable ve Encodable protokollerinin birleşiminden oluşmaktadır. Bu yazıda decode sırasında oluşan hataları ayrıntılı şekilde ele alacağız."/><meta name="og:description" content="İnternetten bir veriyi alıp ya da gönderirken JSON kullanarak aktarmak çok sık kullanılmaktadır. Swift 4 ile hayatımıza giren Codable aslında Decodable ve Encodable protokollerinin birleşiminden oluşmaktadır. Bu yazıda decode sırasında oluşan hataları ayrıntılı şekilde ele alacağız."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/gallery.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/upload-images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="twitter:image" content="https://yusufozgul.com/upload-images/"/><meta name="og:image" content="https://yusufozgul.com/upload-images/"/></head><body class="main-wrapper"><header><link rel="stylesheet" href="/navigationStyle.css" type="text/css"/><nav class="header navBar"><div class="navArea"><input type="checkbox" id="check"/><label for="check"><img src="/upload-images/base/menu-icon.svg" width="30" height="30" class="checkbtn"/></label><label class="logo"><a href="/">Yusuf Özgül</a></label><ul class="navContent" id="hoverEnabled"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li><li><a href="/projects">Projects</a></li><li><a href="/blogs" class="active">Blog</a></li></ul></div></nav></header><div class="wrapper"><h2 class="post-title">Swift Codable ayrıntılı hata ayıklama</h2><a><p>August 24, 2020<br/>Reading 9 minutes</p></a><ul class="tag-list"><li class="swift"><a href="/tags/swift">Swift</a></li><li class="codable"><a href="/tags/codable">Codable</a></li><li class="json"><a href="/tags/json">JSON</a></li><li class="rest"><a href="/tags/rest">REST</a></li></ul><div class="post-description"><div><p>İnternetten bir veriyi alıp ya da gönderirken JSON kullanarak aktarmak çok sık kullanılmaktadır. Swift 4 ile hayatımıza giren Codable aslında Decodable ve Encodable protokollerinin birleşiminden oluşmaktadır. Bu yazıda decode sırasında oluşan hataları ayrıntılı şekilde ele alacağız.</p><p>JSON decode ederken bir çok farklı hata alabiliriz örneğin gelen data geçerli bir json olmayabilir ya da optional olmayan bir field nil gelmiş olabilir. Bunlar için bazı kod satırlarıyla hatanın tam hangi sebepten geldiğini anlayabileceğiz.</p><pre><code><span class="keyword">import</span> UIKit

<span class="keyword">var</span> jsonString: <span class="type">String</span> = <span class="string">"""
{
  "link": "https://yusufozgul.com",
  "data": [
    { "type": "comments", "content": "Lorem Ipsum, dizgi ve baskı endüstrisinde kullanılan mıgır metinlerdir." },
    { "type": "comments", "content": "Lorem Ipsum, adı bilinmeyen bir matbaacının bir hurufat numune kitabı oluşturmak üzere bir yazı galerisini alarak karıştırdığı 1500'lerden beri endüstri standardı sahte metinler olarak kullanılmıştır." }
  ]
}
"""</span>

<span class="keyword">struct</span> CommentResponse: <span class="type">Codable</span> {
    <span class="keyword">let</span> link: <span class="type">String</span>
    <span class="keyword">let</span> data: [<span class="type">CommentResponseData</span>]

    <span class="keyword">enum</span> CodingKeys: <span class="type">String</span>, <span class="type">CodingKey</span> {
        <span class="keyword">case</span> link
        <span class="keyword">case</span> data
    }
}

<span class="keyword">struct</span> CommentResponseData: <span class="type">Codable</span> {
    <span class="keyword">let</span> type: <span class="type">String</span>
    <span class="keyword">let</span> content: <span class="type">String</span>

    <span class="keyword">enum</span> CodingKeys: <span class="type">String</span>, <span class="type">CodingKey</span> {
        <span class="keyword">case</span> type
        <span class="keyword">case</span> content
    }
}

<span class="keyword">let</span> jsonData = jsonString.<span class="call">data</span>(using: .<span class="dotAccess">utf8</span>)

<span class="keyword">if let</span> data = jsonData {
   
    <span class="keyword">do</span> {
        
        <span class="comment">/// json decode etmek için sınıfımızı oluşturuyoruz.</span>
        <span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()
        <span class="keyword">let</span> response = <span class="keyword">try</span> decoder.<span class="call">decode</span>(<span class="type">CommentResponse</span>.<span class="keyword">self</span>, from: data) <span class="comment">/// try ile deneyecek eğer başarısız olursa catch'e düşecek.</span>
        <span class="call">print</span>(response.<span class="property">link</span>)
    } <span class="keyword">catch</span> <span class="type">DecodingError</span>.<span class="call">dataCorrupted</span>(<span class="keyword">let</span> context) {
        <span class="comment">/// Eğer gelen data geçerli bir json değilse veya data ile ilgili başka bir sorun oluşmuşsa buradan hatayı yakalayabiliriz.</span>
        
        <span class="call">print</span>(context.<span class="property">debugDescription</span>)
    } <span class="keyword">catch</span> <span class="type">DecodingError</span>.<span class="call">keyNotFound</span>(<span class="keyword">let</span> key, <span class="keyword">let</span> context) {
        
        <span class="comment">/// Struct'ta bir field var ancak bu optional değil. Gelen json'da bu field bulunamazsa hatamızı buradan yakalayabiliriz ve hangi field olduğunu anlayabiliriz.</span>
        <span class="call">print</span>(<span class="string">"</span>\(key.<span class="property">stringValue</span>) <span class="string">was not found,</span> \(context.<span class="property">debugDescription</span>)<span class="string">"</span>)
    } <span class="keyword">catch</span> <span class="type">DecodingError</span>.<span class="call">typeMismatch</span>(<span class="keyword">let</span> type, <span class="keyword">let</span> context) {
        
        <span class="comment">/// Type safty önemli Struct'ı tanımlarken her field için tipini belirtiyoruz. Gelen json'daki field'ın tipi ile Struct'taki tip uyuşmadığı zaman hatayı buradan yakayabiliriz.</span>
        <span class="call">print</span>(<span class="string">"</span>\(type) <span class="string">was expected,</span> \(context.<span class="property">debugDescription</span>)<span class="string">"</span>)
    } <span class="keyword">catch</span> <span class="type">DecodingError</span>.<span class="call">valueNotFound</span>(<span class="keyword">let</span> type, <span class="keyword">let</span> context) {
        
        <span class="comment">/// Bir field ya optional'dır ya da değildir. Eğer Struct'ta optional tanımlamadınız ve json'da nil gelecek olursa hatayı buradan ele alabilirsiniz.</span>
        <span class="call">print</span>(<span class="string">"no value was found for</span> \(type)<span class="string">,</span> \(context.<span class="property">debugDescription</span>)<span class="string">"</span>)
    } <span class="keyword">catch</span> {
        
        <span class="comment">/// En sonunda hata hala ele alınamamışsa burdan alıyoruz.</span>
        <span class="call">print</span>(<span class="string">"Other Error"</span>)
    }
}
</code></pre><p>Umarım açıklayıcı olmuştur, bana sorularınız için iletişim sayfasını ya da yorumları kullanabilirsiniz, bir başka yazımda görüşmek üzere.</p><p>Proje Dosyası için: <a href="https://github.com/yusufozgul/Swift-Projects/tree/master/CodableDetailedDebugging.playground "GitHub hesabım"">GitHub hesabım</a></p></div></div></div><footer><p><a href="https://github.com/johnsundell/publish">Generated using Publish</a></p><p><a href="/feed.rss">RSS feed</a></p><p><a href="https://github.com/yusufozgul">Developed Yusuf Özgül</a></p></footer></body></html>