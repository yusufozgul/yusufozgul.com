<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Yusuf Özgül | Blog | Resume | Portfolio"/><link rel="canonical" href="https://yusufozgul.com/blogs/parallel-async-await-TR"/><meta name="twitter:url" content="https://yusufozgul.com/blogs/parallel-async-await-TR"/><meta name="og:url" content="https://yusufozgul.com/blogs/parallel-async-await-TR"/><title>Swift Paralel Async İstekler | Yusuf Özgül | Blog | Resume | Portfolio</title><meta name="twitter:title" content="Swift Paralel Async İstekler | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="og:title" content="Swift Paralel Async İstekler | Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="description" content="Async Await ile birden fazla isteği aynı anda nasıl atabilirsiniz?"/><meta name="twitter:description" content="Async Await ile birden fazla isteği aynı anda nasıl atabilirsiniz?"/><meta name="og:description" content="Async Await ile birden fazla isteği aynı anda nasıl atabilirsiniz?"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/gallery.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/upload-images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Yusuf Özgül | Blog | Resume | Portfolio"/><meta name="twitter:image" content="https://yusufozgul.com/upload-images/"/><meta name="og:image" content="https://yusufozgul.com/upload-images/"/></head><body class="main-wrapper"><header><link rel="stylesheet" href="/navigationStyle.css" type="text/css"/><nav class="header navBar"><div class="navArea"><input type="checkbox" id="check"/><label for="check"><img src="/upload-images/base/menu-icon.svg" width="30" height="30" class="checkbtn"/></label><label class="logo"><a href="/">Yusuf Özgül</a></label><ul class="navContent" id="hoverEnabled"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li><li><a href="/projects">Projects</a></li><li><a href="/blogs" class="active">Blog</a></li></ul></div></nav></header><div class="wrapper"><h2 class="post-title">Swift Paralel Async İstekler</h2><a><p>November 7, 2021<br/>Reading 7 minutes</p></a><ul class="tag-list"><li class="swift"><a href="/tags/swift">Swift</a></li><li class="other"><a href="/tags/asyncawait">Async-Await</a></li></ul><div class="post-description"><div><p>Swift 5.5 ile hayatımıza giren ve geriye uyumluluk desteği ile iOS 13 ve üzerinde kullanabildiğimiz Async Await ile nasıl aynı anda birden fazla istek atabiliriz?</p><h3>Async İstek Nasıl Atılır</h3><p>Aşağıdaki örnek tipik bir async istek için kullanılabilecek fonksiyon tanımlanması</p><pre><code><span class="keyword">func</span> fetchMovie() <span class="keyword">async throws</span> -&gt; <span class="type">MovieResponse</span> {
    <span class="comment">// ...</span>
}
</code></pre><p>Fonksiyonun içerisini ise şu şekilde doldurabiliriz</p><pre><code><span class="keyword">func</span> fetchMovie() <span class="keyword">async throws</span> -&gt; <span class="type">MovieResponse</span> {
    <span class="keyword">let</span> (data, response) = <span class="keyword">try await</span> <span class="type">URLSession</span>.<span class="property">shared</span>.<span class="call">data</span>(from: url)
        <span class="keyword">return try</span> decoder.<span class="call">decode</span>(<span class="type">MovieResponse</span>.<span class="keyword">self</span>, from: data)
}
</code></pre><p>Bu fonksiyonu çağırmak için ise normal fonksiyon çağrısı yapıp başına await eklememiz olacak.</p><p>Peki yukarıdaki şekilde her seferinde tek istekten veri alabiliriz aynı anda istek atıp tüm istekler gelince aynı anda nasıl alabiliriz?</p><pre><code><span class="keyword">func</span> fetchAllMovies() <span class="keyword">async</span> {
    <span class="keyword">var</span> movies: [<span class="type">MovieResponse</span>] = []
    
    <span class="keyword">try await</span> <span class="call">withThrowingTaskGroup</span>(of: <span class="type">MovieResponse</span>.<span class="keyword">self</span>, body: { taskGroup <span class="keyword">in
      for</span> movieId <span class="keyword">in</span> movies {
            taskGroup.<span class="call">addTask</span> { <span class="keyword">try await self</span>.<span class="call">fetchMovie</span>(movieId: movieId) }
        }
        <span class="keyword">while let</span> movie = <span class="keyword">try await</span> taskGroup.<span class="call">next</span>() {
            movies.<span class="call">append</span>(movie)
        }
    })

    movies .... <span class="comment">// all movies fetched</span>
}
</code></pre><p>Şimdi adım adım inceleyelim, başlangıç olarak elimizde boş array var, ardından bir task group içinde bazı işlemler yaptık adından da anlaşılacağı üzere içinde birden fazla aynı iş yapmamızı ve hepsi bitince geriye dönmesini sağlıyor. For ile tüm isteklerimizi addTask diyerek ekledik, ardından while içinde task'ın sonucunun gelmesini bekledik. Tüm istekler sonuçlanınca array'imiz dolmuş oldu.</p><blockquote><p>Burada önemli bir noktayı belirtmek istiyorum bu withThrowingTaskGroup isteklerinizin attığımız sırayla gelmesini garanti etmez, bunun için sizin sonradan sıralama yapmanız gerekmektedir.</p></blockquote><p>Bu blog yazısında nasıl aynı anda birden fazla istek atıp sonuçlarını await ile alabilirizi anlattım, okuduğunuz için teşekkür ederim, bu konuyu araştırırken okuduğum yazıları aşağıda bulabilirsiniz.</p><p>https://www.avanderlee.com/swift/async-await/ https://tanaschita.com/20210630-how-to-call-async-await-functions-concurrently/ https://www.avanderlee.com/swift/async-let-asynchronous-functions-in-parallel/</p></div></div></div><footer><p><a href="https://github.com/johnsundell/publish">Generated using Publish</a></p><p><a href="/feed.rss">RSS feed</a></p><p><a href="https://github.com/yusufozgul">Developed Yusuf Özgül</a></p></footer></body></html>